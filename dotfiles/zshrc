#!/usr/bin/env zsh

### Added by Zinit's installer
. "$HOME/.zinit/bin/zinit.zsh"
autoload -Uz _zinit
(( ${+_comps} )) && _comps[zinit]=_zinit
### End of Zinit installer's chunk

zinit snippet OMZL::compfix.zsh
zinit snippet "${HOME}"/dotfiles/zcompdump.zsh
zinit snippet "${HOME}"/dotfiles/keybindings.zsh
zinit snippet OMZL::completion.zsh
zinit snippet OMZL::diagnostics.zsh
zinit snippet OMZL::functions.zsh
zinit snippet OMZL::git.zsh
zinit snippet OMZL::termsupport.zsh
zinit snippet OMZL::theme-and-appearance.zsh

autoload -U compaudit compinit

zinit light romkatv/zsh-prompt-benchmark
zinit ice depth=1; zinit light sobolevn/wakatime-zsh-plugin
zinit snippet OMZP::sprunge
# Rust programming language
zinit ice as"completion" wait'!2' silent
zinit snippet OMZ::plugins/cargo/_cargo
zinit ice as"completion" wait'!2' silent
zinit snippet OMZ::plugins/rust/_rust
zinit ice as"completion" wait'!2' silent
zinit snippet ~/dotfiles/zfunc/_rustup
# Prompt
zinit ice svn
zinit snippet OMZ::plugins/git-prompt
zinit snippet "${HOME}"/dotfiles/berquist.zsh-theme

unsetopt auto_cd
setopt auto_pushd
setopt beep
unsetopt extended_glob
setopt interactive_comments
setopt long_list_jobs
setopt multios  # TODO I don't understand this
setopt nomatch
unsetopt notify
setopt prompt_subst
setopt pushd_ignore_dups

# The following lines were added by compinstall
zstyle :compinstall filename "${HOME}/.zshrc"
autoload -Uz compinit
compinit
# End of lines added by compinstall

. "${HOME}"/dotfiles/history.zsh
. "${HOME}"/dotfiles/interactive_exports.bash
. "${HOME}"/dotfiles/aliases.bash 
. "${HOME}"/dotfiles/functions.bash
. "${HOME}"/dotfiles/slurm.bash

{%@@ if profile == "osmium" @@%}
# re-export
export QCPROGS="${HOME}/data/opt/apps"
export apps="${QCPROGS}"

. /usr/bin/virtualenvwrapper.sh

source /usr/share/lmod/lmod/init/zsh
module use "${HOME}/modules/osmium"
{%@@ elif profile == "sodium.local" @@%}
## #####################
## ## Setting Mac OS X
## ## Terminal.app name.
## ## This code goes to
## ## all your ~/.bashrc or
## ## ~/.bash_profile files.
## ## Now you can jump from
## ## machine to machine and
## ## never get lost.
## #####################

## -----------------------------
## -- this runs when you get new
## -- you get new interactive bash
## -- shell - the condition is needed
## -- so it will not interrupt the scp command

if [[ "$-" =~ "i" ]]; then
    echo -n -e "\033]0;${USER}@${HOSTNAME%%.*}\007";
fi;

## -----------------------------
## -- this runs when you logoff
## -- from a ssh session - it puts
## -- back previous terminal name;

function ssh() {
    /usr/bin/ssh "$@";
    echo -n -e "\033]0;${USER}@${HOSTNAME%%.*}\007";
}

. ~/dotfiles/aliases_macos.bash

# export MATLAB_ROOT='/Applications/MATLAB_R2012a.app'
# export MATLAB_BIN="${MATLAB_ROOT}/bin"
# export PATH="${PATH}:${MATLAB_BIN}"

. /usr/local/opt/lmod/init/zsh
module use "${HOME}/modules/sodium"

module load python/psi4conda
{%@@ endif @@%}

eval "$(direnv hook $(basename $SHELL))"
